{% extends 'base.html.twig' %}

{% block title %}
    MSINGMD|Welcome
{% endblock %}

{% block body %}
    {% if app.user %}
        <center>
            {% if app.user.userType == 'doctor' %}
                <div class="mb-3">
                    You are logged in as <a class="font-weight-bold" href="{{ path('medAccount') }}">{{ app.user.username }}</a> ({{ app.user.userType }})
                </div>
            {% else %}
                <div class="mb-3">
                    You are logged in as <a class="font-weight-bold" href="{{ path('patAccount') }}">{{ app.user.username }}</a> ({{ app.user.userType }})
                </div>
            {% endif %}

            {% if app.user.userType == 'doctor' %}
                <div class="mb-3">
                    Click on your email to get into your account.
                </div>

                {# IS A PATIENT#}
            {% else %}
                <div class="mb-3">
                    Upload your medical file <a style="font-weight: bold" href="{{ path('uploadfile') }}">here</a>.
                </div>
                {% if (userFiles is defined) and (userFiles is not empty) %}
                    <div class="table-responsive-lg">
                        <table class="table table-striped table-bordered d-lg-table-cell">
                            <tr>
                                <th>File</th>
                                <th>Type</th>
                                <th>Submitted to</th>
                                <th>Comments</th>
                                <th>Options</th>
                            </tr>

                            {% for key, userFile in userFiles %}

                                {% if key is defined or userFiles is defined %}
                                <tr>
                                    <td>{{ userFile.fileName|split('_')[1] }}</td>
                                    <td>{{ userFile.docType }}</td>
                                    <td>{{ userFile.doctorMail }}</td>
                                    <td>
                                        {% if userFile.comment %}
                                            <i class="fas fa-check"></i>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <a  title="View document" style="font-weight: bold" href="{{ uploaded_asset(userFile.imagePath) }}" target="_blank" ><i class="fa fa-eye"></i></a>
                                        {% if key %}
                                            <a title="Submit document" style="font-weight: bold" href="{{ path('medform', {'id': key} ) }}"><i class="fas fa-cloud-upload-alt"></i></a>
                                        {% endif %}
                                        {% if userFile.comment %}
                                            <a title="View medical comment" style="font-weight: bold" href="{{ path('viewComment', {'id': key} ) }}"><i class="fas fa-comment-medical"></i></a>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endif %}
                            {% endfor %}
                        </table>
                    </div>

                {% endif %}
            {% endif %}
        <br />

       </center>
    {% endif %}


{% endblock %}


{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.2/jquery.modal.css" integrity="sha256-I7TkE/ugn9CLcKj70NkHs+j2cTVR6PAFPoFvk5DMrXg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.2/jquery.modal.min.css" integrity="sha256-6qWTvP5IX0taismXz5k2YE+fvvkWUtuUqOIrddYSv8E=" crossorigin="anonymous" />

{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.2/jquery.modal.js" integrity="sha256-Xn32xgoXnSJx7yF1Tc0WFkI8WbupFklylorHLBeu0CA=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.2/jquery.modal.min.js" integrity="sha256-lw0IsO3Ev8CSVJXYsRVk88L9No90X3s1EKf87RGEiJQ=" crossorigin="anonymous"></script>
{% endblock %}


